<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Translator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/style.css') }}">
    <!-- <link rel="stylesheet" href="style.css"> -->
  </head>
  <body>
    <header>
        <nav class="navbar">
            <a class="logo" href="index.html">PalmVerse<span>.</span></a>
                <div class="content">
                  <h2>Select Your Language</h2>
                  
                      <label for="languages">Choose a language:</label>
          
                      <select name="languages" id="languages">
                        <option value="en">English(US)</option>
                        <option value="am">Amharic</option>
                        <option value="ar">Arabic</option>
                        <option value="eu">Basque</option>
                        <option value="bn">Bengali</option>
                        <option value="en-GB">English(UK)</option>
                        <option value="pt-BR">Portugues(Brazil)</option>
                        <option value="bg">Bulgarian</option>
                        <option value="ca">Catalan</option>
                        <option value="chr">Cherokee</option>
                        <option value="hr">Croatian</option>
                        <option value="cs">Czech</option>
                        <option value="da">Danish</option>
                        <option value="nl">Dutch</option>
                        <option value="en">Estonian</option>
                        <option value="fil">Filipino</option>
                        <option value="fi">Finnish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="el">Greek</option>
                        <option value="gu">Gujarati</option>
                        <option value="iw">Hebrew</option>
                        <option value="hi">Hindi</option>
                        <option value="hu">Hungarian</option>
                        <option value="is">Icelandic</option>
                        <option value="id">Indonesian</option>
                        <option value="it">Italian</option>
                        <option value="ja">Japanese</option>
                        <option value="kn">Kannada</option>
                        <option value="ko">Korean</option>
                        <option value="lv">Latvian</option>
                        <option value="lt">Lithuanian</option>
                        <option value="ms">Malay</option>
                        <option value="ml">Malayalam</option>
                        <option value="mr">Marathi</option>
                        <option value="no">Norwegian</option>
                        <option value="pl">Polish</option>
                        <option value="pt-PT">Portuguese(Portugal)</option>
                        <option value="ro">Romanian</option>
                        <option value="ru">Russian</option>
                        <option value="sr">Serbian</option>
                        <option value="zh-CN">Chinese(PRC)</option>
                        <option value="sk">Slovak</option>
                        <option value="sl">Slovenian</option>
                        <option value="es">Spanish</option>
                        <option value="sw">Swahili</option>
                        <option value="sv">Swedish</option>
                        <option value="ta">Tamil</option>
                        <option value="te">Telugu</option>
                        <option value="th">Thai</option>
                        <option value="zh-TW">Chinese(Taiwan)</option>
                        <option value="tr">Turkish</option>
                        <option value="ur">Urdu</option>
                        <option value="uk">Ukrainian</option>
                        <option value="vi">Vietnamese</option>
                        <option value="cy">Welsh</option>
                      </select>
                </div>
                <ul class="menu-links">
                  <span id="close-menu-btn" class="material-symbols-outlined">close</span>
                  <!-- <li><a href="howto.html">How To Use</a></li> -->
                  <li><a href="https://github.com/PsyDak-Meng/PalmVerse">About Us</a></li>
                </ul>
                <span id="hamburger-btn" class="material-symbols-outlined">menu</span>
    </header>
  </nav>
    <section class="hero-section">
      <svg class="rectangle">
        <rect x="0" y="0" width="100%" height="100%" fill="white" opacity="45%"/>
     </svg>
        <!--Centered Live Cam Start-->
      <div class="cam" style="text-align: center;">
          <img src="{{ url_for('video_feed') }}" width="60%" class="center" alt="Open live cam for hand tracking feed~~">
      </div>

      <button onclick="speakPrediction()" class="speak-button" type="button">Text to Speech</button>
      <script>
        function speakPrediction() {
            var prediction = document.getElementById("prediction_text").value;
            var synth = window.speechSynthesis;

            // Create a new SpeechSynthesisUtterance object
            var utterThis = new SpeechSynthesisUtterance(prediction);

            // Set the voice to Google's TTS voice
            utterThis.voice = speechSynthesis.getVoices().find(voice => voice.name === 'Google US English');

            // Speak the prediction
            synth.speak(utterThis);
        }
      </script>


      <!-- Delete -->
      <button onclick="deleteText()" class="delete-button" type="button">Delete</button>
      <script>
        function deleteText() {
            event.preventDefault();  // Prevent default form submission behavior
            fetch('/delete_text', { method: 'POST' })  // Send POST request to Flask route '/delete_text'
                .then(response => {
                    if (response.ok) {
                        document.getElementById('prediction_text').value = ''; // Clear the text area on success
                    } else {
                        console.error('Error:', response.statusText);
                    }
                })
                .catch(error => console.error('Error:', error));
        }
    </script>
      <!-- <script>
      function clearTextbox() {
        document.getElementById("prediction_text").value = ""; // Clear the textbox
      }
      </script> -->



      <!-- Translate -->
      <button onclick="translateText()" class="translate-button">Translate</button><br>
      <script>
        function translateText() {
            var inputText = document.getElementById("prediction_text").value;
            var targetLanguage = document.getElementById("languages").value;

            fetch(`https://translation.googleapis.com/language/translate/v2?key=AIzaSyD_eHHWM-pxDaUV9wz3edeF3d9mXNmM988`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    q: prediction_text,
                    target: languages
                })
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("prediction_text").value = data.data.translations[0].translatedText;
            })
            .catch(error => console.error('Error:', error));
        }
      </script>



      <!-- Textbox -->
      <textarea class="text-box" id="prediction_text" placeholder="Please enter your text..." contenteditable></textarea>
      <script>
        function fetchTextAndUpdate() {
            fetch('/output_text')  // Assuming Flask route to get updated text is '/get_text'
                .then(response => response.text())
                .then(text => {
                    document.getElementById('prediction_text').value = text;
                })
                .catch(error => console.error('Error:', error));
        }

        // Fetch and update text initially
        fetchTextAndUpdate();

        // Fetch and update text every 5 seconds (adjust interval as needed)
        setInterval(fetchTextAndUpdate, 300);
    </script>
              <!-- {% if output %}
        <p>Processed Output: {{ output }}</p>
        {% endif %} -->

      
    </section>
<script>
  //TODO: add language translator and camera access
  //TODO: add text/CC box
  fetch('https://translation.googleapis.com/language/translate/v2?key=AIzaSyC449Bf8vA6Em3vV62cdMRGaKO6gk-8hiU')
  .then(response => response.json()) // Parse response as JSON
  .then(data => {
    console.log(data);
  })
</script>

  </body>
</html>